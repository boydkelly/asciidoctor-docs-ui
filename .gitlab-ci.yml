image: node:10.14.2-stretch
stages: [setup, verify, deploy]
install:
  stage: setup
  cache:
    paths:
    - .cache/npm
  script:
  - &npm_install
    npm install --quiet --no-progress --cache=.cache/npm
lint:
  stage: verify
  cache: &pull_cache
    policy: pull
    paths:
    - .cache/npm
  script:
  - *npm_install
  - node_modules/.bin/gulp lint
bundle-stable:
  stage: deploy
  only:
  - julakn-main@boydkelly/julakan-docs-ui
  cache: *pull_cache
  script:
  - *npm_install
  - node_modules/.bin/gulp bundle
  artifacts:
    paths:
    - build/ui-bundle.zip
trigger_build:
  stage: deploy
  script:
    - "curl -X POST -F token=7dc04d6e26af2933756aa6fa63a687 -F ref=main https://gitlab.com/api/v4/projects/18171487/trigger/pipeline"
